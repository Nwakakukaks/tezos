{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/box-defi/dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/workspace/box-defi/dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/workspace/box-defi/dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";// Components\nimport Button from\"../components/Button\";// Data\nimport{info}from\"../data\";// Hooks\nimport{useActions,useTypedSelector}from\"../hooks\";// Utils\nimport{divide,multiply}from\"../utils/math\";import{formatTokenBalance}from\"../utils/strings\";import{blockInvalidChars}from\"../utils/input\";// Operations\nimport{lockTokens,unlockTokens}from\"../operations/pool\";// Assets\nimport SEED from\"../assets/icons/seed.png\";import kUSD from\"../assets/icons/kUSD.png\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Pool=function Pool(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),selected=_useState2[0],setSelected=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),kUSDValue=_useState4[0],setkUSDValue=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),seedValue=_useState6[0],setSeedValue=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useActions=useActions(),setLoading=_useActions.setLoading,setSuccess=_useActions.setSuccess,setFailure=_useActions.setFailure;var _useTypedSelector=useTypedSelector(function(state){return state.wallet;}),tokenBalances=_useTypedSelector.tokenBalances,isConnected=_useTypedSelector.isConnected;var _useTypedSelector2=useTypedSelector(function(state){return state.stats;}),seedSupply=_useTypedSelector2.seedSupply,kUSDLocked=_useTypedSelector2.kUSDLocked;// Recalibrates output value of one tokens w.r.t to the other and operation type\nuseEffect(function(){// If locking tokens\nif(selected===0){setSeedValue(divide(divide(multiply(multiply(kUSDValue,Math.pow(10,18)),seedSupply),kUSDLocked),Math.pow(10,18)));}else if(selected===1){setkUSDValue(divide(divide(multiply(multiply(seedValue,Math.pow(10,18)),kUSDLocked),seedSupply),Math.pow(10,18)));}},[kUSDValue,seedValue,kUSDLocked,seedSupply,selected]);var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var op,_op;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// Input validation\nsetError(\"\");if(!(selected===0)){_context.next=7;break;}if(!(parseFloat(kUSDValue)>parseFloat(divide(tokenBalances.kUSD,Math.pow(10,18)))||kUSDValue===\"0\")){_context.next=5;break;}setError(\"Invalid kUSD amount!\");return _context.abrupt(\"return\");case 5:_context.next=10;break;case 7:if(!(parseFloat(seedValue)>parseFloat(divide(tokenBalances.SEED,Math.pow(10,18)))||seedValue===\"0\")){_context.next=10;break;}setError(\"Invalid SEED amount!\");return _context.abrupt(\"return\");case 10:if(!(selected===0)){_context.next=29;break;}_context.prev=11;_context.next=14;return lockTokens(kUSDValue);case 14:op=_context.sent;if(!op){_context.next=22;break;}setLoading(\"Locking kUSD\");_context.next=19;return op.send();case 19:_context.next=21;return _context.sent.confirmation(1);case 21:setSuccess(\"Lockup of kUSD successful!\");case 22:_context.next=27;break;case 24:_context.prev=24;_context.t0=_context[\"catch\"](11);setFailure(\"Locking Failed: \".concat(_context.t0.message));case 27:_context.next=45;break;case 29:_context.prev=29;_context.next=32;return unlockTokens(seedValue);case 32:_op=_context.sent;if(!_op){_context.next=40;break;}setLoading(\"Unlocking kUSD\");_context.next=37;return _op.send();case 37:_context.next=39;return _context.sent.confirmation(1);case 39:setSuccess(\"Unlock of kUSD successful!\");case 40:_context.next=45;break;case 42:_context.prev=42;_context.t1=_context[\"catch\"](29);setFailure(\"Unlocking Failed: \".concat(_context.t1.message));case 45:case\"end\":return _context.stop();}}},_callee,null,[[11,24],[29,42]]);}));return function submit(){return _ref.apply(this,arguments);};}();var kUSDInput=/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center rounded-lg bg-fadedWhite md:w-3/4 m-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-2 rounded-tl-lg rounded-bl-lg bg-bgGreen2\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-7\",alt:\"kUSD\",src:kUSD}),/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-semibold ml-2\",children:\"kUSD\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:kUSDValue,onKeyDown:blockInvalidChars([\"-\",\"+\",\"e\",\"E\"]),onChange:function onChange(e){return setkUSDValue(e.target.value);},className:\"min-w-0 w-2/4 flex-grow rounded-tr-lg rounded-br-lg bg-fadedWhite focus:outline-none text-xl px-2\",placeholder:selected===0?\"0.00\":\"kUSD received (Approx)\",disabled:selected===1}),selected===0&&/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setkUSDValue(divide(tokenBalances.kUSD,Math.pow(10,18)));},className:\"text-base font-semibold text-fadedBlack opacity-70 hover:opacity-100 mr-2 cursor-pointer\",children:\"MAX\"})]});var SEEDInput=/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center rounded-lg bg-fadedWhite md:w-3/4 m-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-2 rounded-tl-lg rounded-bl-lg bg-bgBrown\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-7\",alt:\"kUSD\",src:SEED}),/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-semibold ml-2\",children:\"SEED\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:seedValue,onKeyDown:blockInvalidChars([\"-\",\"+\",\"e\",\"E\"]),onChange:function onChange(e){return setSeedValue(e.target.value);},className:\"min-w-0 w-2/4 flex-grow rounded-tr-lg rounded-br-lg bg-fadedWhite focus:outline-none text-xl px-2\",placeholder:selected===1?\"0.00\":\"SEED received (Approx)\",disabled:selected===0}),selected===1&&/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setSeedValue(divide(tokenBalances.SEED,Math.pow(10,18)));},className:\"text-base font-semibold text-fadedBlack opacity-70 hover:opacity-100 mr-2 cursor-pointer\",children:\"MAX\"})]});return/*#__PURE__*/_jsxs(\"div\",{className:\"font-secondary rounded-lg bg-white p-6 md:w-3/4 mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-fadedBlack text-base md:text-xl mb-1\",children:\"\\uD83D\\uDD12 Locked kUSD\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-2xl\",children:formatTokenBalance(kUSDLocked,18)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-fadedBlack text-base md:text-xl mb-1\",children:\"\\uD83C\\uDF30 Seed Supply\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-2xl\",children:formatTokenBalance(seedSupply,18)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-fadedBlack text-base md:text-xl mb-1\",children:\"\\uD83D\\uDE80 Flash Loan Fee\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-2xl\",children:\"1.00 %\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-12\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center gap-x-6 items-center text-2xl transition-all duration-300\",children:[/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return setSelected(0);},className:\"cursor-pointer flex flex-col gap-y-1 items-center \".concat(selected===0?\"text-black\":\"text-fadedBlack\"),children:[\"Lock\",/*#__PURE__*/_jsx(\"span\",{className:\"h-0.5 w-full m-auto \".concat(selected===0&&\"bg-black\")})]}),/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return setSelected(1);},className:\"cursor-pointer flex flex-col gap-y-1 \".concat(selected===1?\"text-black\":\"text-fadedBlack\"),children:[\"Unlock\",/*#__PURE__*/_jsx(\"span\",{className:\"h-0.5 w-full m-auto \".concat(selected===1&&\"bg-black\")})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 flex flex-col items-center gap-y-4\",children:[error&&/*#__PURE__*/_jsxs(\"div\",{className:\"md:w-3/4 m-auto text-left text-base text-red-500 -mb-3\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-exclamation-circle mr-2\"}),error]}),/*#__PURE__*/_jsxs(React.Fragment,{children:[selected===0?kUSDInput:SEEDInput,/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-arrow-down-circle-fill text-blue-500 text-xl\"}),selected===1?kUSDInput:SEEDInput,/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:selected===0?/*#__PURE__*/_jsx(Button,{disabled:!isConnected,text:\"Lock Tokens\",icon:\"lock-fill\",background:\"bg-bgGreen2\",onClick:submit}):/*#__PURE__*/_jsx(Button,{disabled:!isConnected,text:\"Unlock Tokens\",icon:\"unlock-fill\",background:\"bg-bgBrown\",onClick:submit})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 rounded-lg bg-gray-200 p-3 md:w-10/12 m-auto\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-info-circle mr-1\"}),info.pool]})]})]});};export default Pool;","map":{"version":3,"sources":["/workspace/box-defi/dapp/src/pages/Pool.tsx"],"names":["React","useState","useEffect","Button","info","useActions","useTypedSelector","divide","multiply","formatTokenBalance","blockInvalidChars","lockTokens","unlockTokens","SEED","kUSD","Pool","selected","setSelected","kUSDValue","setkUSDValue","seedValue","setSeedValue","error","setError","setLoading","setSuccess","setFailure","state","wallet","tokenBalances","isConnected","stats","seedSupply","kUSDLocked","submit","parseFloat","op","send","confirmation","message","kUSDInput","e","target","value","SEEDInput","pool"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\n\n// Components\nimport Button from \"../components/Button\";\n\n// Data\nimport { info } from \"../data\";\n\n// Hooks\nimport { useActions, useTypedSelector } from \"../hooks\";\n\n// Utils\nimport { divide, multiply } from \"../utils/math\";\nimport { formatTokenBalance } from \"../utils/strings\";\nimport { blockInvalidChars } from \"../utils/input\";\n\n// Operations\nimport { lockTokens, unlockTokens } from \"../operations/pool\";\n\n// Assets\nimport SEED from \"../assets/icons/seed.png\";\nimport kUSD from \"../assets/icons/kUSD.png\";\n\nconst Pool = () => {\n  const [selected, setSelected] = useState<number>(0);\n  const [kUSDValue, setkUSDValue] = useState<string>(\"\");\n  const [seedValue, setSeedValue] = useState<string>(\"\");\n  const [error, setError] = useState<string>(\"\");\n\n  const { setLoading, setSuccess, setFailure } = useActions();\n\n  const { tokenBalances, isConnected } = useTypedSelector((state) => state.wallet);\n  const { seedSupply, kUSDLocked } = useTypedSelector((state) => state.stats);\n\n  // Recalibrates output value of one tokens w.r.t to the other and operation type\n  useEffect(() => {\n    // If locking tokens\n    if (selected === 0) {\n      setSeedValue(divide(divide(multiply(multiply(kUSDValue, 10 ** 18), seedSupply), kUSDLocked), 10 ** 18));\n    } else if (selected === 1) {\n      setkUSDValue(divide(divide(multiply(multiply(seedValue, 10 ** 18), kUSDLocked), seedSupply), 10 ** 18));\n    }\n  }, [kUSDValue, seedValue, kUSDLocked, seedSupply, selected]);\n\n  const submit = async () => {\n    // Input validation\n    setError(\"\");\n    if (selected === 0) {\n      if (parseFloat(kUSDValue) > parseFloat(divide(tokenBalances.kUSD, 10 ** 18)) || kUSDValue === \"0\") {\n        setError(\"Invalid kUSD amount!\");\n        return;\n      }\n    } else {\n      if (parseFloat(seedValue) > parseFloat(divide(tokenBalances.SEED, 10 ** 18)) || seedValue === \"0\") {\n        setError(\"Invalid SEED amount!\");\n        return;\n      }\n    }\n\n    if (selected === 0) {\n      try {\n        const op = await lockTokens(kUSDValue);\n        if (op) {\n          setLoading(\"Locking kUSD\");\n          await (await op.send()).confirmation(1);\n          setSuccess(\"Lockup of kUSD successful!\");\n        }\n      } catch (err: any) {\n        setFailure(`Locking Failed: ${err.message}`);\n      }\n    } else {\n      try {\n        const op = await unlockTokens(seedValue);\n        if (op) {\n          setLoading(\"Unlocking kUSD\");\n          await (await op.send()).confirmation(1);\n          setSuccess(\"Unlock of kUSD successful!\");\n        }\n      } catch (err: any) {\n        setFailure(`Unlocking Failed: ${err.message}`);\n      }\n    }\n  };\n\n  const kUSDInput = (\n    <div className=\"flex items-center rounded-lg bg-fadedWhite md:w-3/4 m-auto\">\n      <div className=\"flex items-center p-2 rounded-tl-lg rounded-bl-lg bg-bgGreen2\">\n        <img className=\"w-7\" alt=\"kUSD\" src={kUSD} />\n        <span className=\"text-lg font-semibold ml-2\">kUSD</span>\n      </div>\n      <input\n        type=\"number\"\n        value={kUSDValue}\n        onKeyDown={blockInvalidChars([\"-\", \"+\", \"e\", \"E\"])}\n        onChange={(e) => setkUSDValue(e.target.value)}\n        className=\"min-w-0 w-2/4 flex-grow rounded-tr-lg rounded-br-lg bg-fadedWhite focus:outline-none text-xl px-2\"\n        placeholder={selected === 0 ? \"0.00\" : \"kUSD received (Approx)\"}\n        disabled={selected === 1}\n      />\n      {selected === 0 && (\n        <span\n          onClick={() => setkUSDValue(divide(tokenBalances.kUSD, 10 ** 18))}\n          className=\"text-base font-semibold text-fadedBlack opacity-70 hover:opacity-100 mr-2 cursor-pointer\"\n        >\n          MAX\n        </span>\n      )}\n    </div>\n  );\n\n  const SEEDInput = (\n    <div className=\"flex items-center rounded-lg bg-fadedWhite md:w-3/4 m-auto\">\n      <div className=\"flex items-center p-2 rounded-tl-lg rounded-bl-lg bg-bgBrown\">\n        <img className=\"w-7\" alt=\"kUSD\" src={SEED} />\n        <span className=\"text-lg font-semibold ml-2\">SEED</span>\n      </div>\n      <input\n        type=\"number\"\n        value={seedValue}\n        onKeyDown={blockInvalidChars([\"-\", \"+\", \"e\", \"E\"])}\n        onChange={(e) => setSeedValue(e.target.value)}\n        className=\"min-w-0 w-2/4 flex-grow rounded-tr-lg rounded-br-lg bg-fadedWhite focus:outline-none text-xl px-2\"\n        placeholder={selected === 1 ? \"0.00\" : \"SEED received (Approx)\"}\n        disabled={selected === 0}\n      />\n      {selected === 1 && (\n        <span\n          onClick={() => setSeedValue(divide(tokenBalances.SEED, 10 ** 18))}\n          className=\"text-base font-semibold text-fadedBlack opacity-70 hover:opacity-100 mr-2 cursor-pointer\"\n        >\n          MAX\n        </span>\n      )}\n    </div>\n  );\n\n  return (\n    <div className=\"font-secondary rounded-lg bg-white p-6 md:w-3/4 mx-auto\">\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-y-6\">\n        <div className=\"flex flex-col items-center\">\n          <div className=\"font-medium text-fadedBlack text-base md:text-xl mb-1\">🔒 Locked kUSD</div>\n          <div className=\"font-semibold text-2xl\">{formatTokenBalance(kUSDLocked, 18)}</div>\n        </div>\n        <div className=\"flex flex-col items-center\">\n          <div className=\"font-medium text-fadedBlack text-base md:text-xl mb-1\">🌰 Seed Supply</div>\n          <div className=\"font-semibold text-2xl\">{formatTokenBalance(seedSupply, 18)}</div>\n        </div>\n        <div className=\"flex flex-col items-center\">\n          <div className=\"font-medium text-fadedBlack text-base md:text-xl mb-1\">🚀 Flash Loan Fee</div>\n          <div className=\"font-semibold text-2xl\">1.00 %</div>\n        </div>\n      </div>\n      <div className=\"mt-12\">\n        <div className=\"flex justify-center gap-x-6 items-center text-2xl transition-all duration-300\">\n          <div\n            onClick={() => setSelected(0)}\n            className={`cursor-pointer flex flex-col gap-y-1 items-center ${\n              selected === 0 ? \"text-black\" : \"text-fadedBlack\"\n            }`}\n          >\n            Lock\n            <span className={`h-0.5 w-full m-auto ${selected === 0 && \"bg-black\"}`}></span>\n          </div>\n          <div\n            onClick={() => setSelected(1)}\n            className={`cursor-pointer flex flex-col gap-y-1 ${selected === 1 ? \"text-black\" : \"text-fadedBlack\"}`}\n          >\n            Unlock\n            <span className={`h-0.5 w-full m-auto ${selected === 1 && \"bg-black\"}`}></span>\n          </div>\n        </div>\n        <div className=\"mt-8 flex flex-col items-center gap-y-4\">\n          {error && (\n            <div className=\"md:w-3/4 m-auto text-left text-base text-red-500 -mb-3\">\n              <i className=\"bi bi-exclamation-circle mr-2\" />\n              {error}\n            </div>\n          )}\n          <React.Fragment>\n            {selected === 0 ? kUSDInput : SEEDInput}\n            <i className=\"bi bi-arrow-down-circle-fill text-blue-500 text-xl\" />\n            {selected === 1 ? kUSDInput : SEEDInput}\n            <div className=\"mt-4\">\n              {selected === 0 ? (\n                <Button\n                  disabled={!isConnected}\n                  text=\"Lock Tokens\"\n                  icon=\"lock-fill\"\n                  background=\"bg-bgGreen2\"\n                  onClick={submit}\n                />\n              ) : (\n                <Button\n                  disabled={!isConnected}\n                  text=\"Unlock Tokens\"\n                  icon=\"unlock-fill\"\n                  background=\"bg-bgBrown\"\n                  onClick={submit}\n                />\n              )}\n            </div>\n          </React.Fragment>\n        </div>\n        <div className=\"mt-8 rounded-lg bg-gray-200 p-3 md:w-10/12 m-auto\">\n          <i className=\"bi bi-info-circle mr-1\" />\n          {info.pool}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Pool;\n"]},"metadata":{},"sourceType":"module"}