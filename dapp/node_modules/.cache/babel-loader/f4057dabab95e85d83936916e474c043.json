{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/box-defi/dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/workspace/box-defi/dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";// Utils\nimport{apiURL}from\"../utils/global\";export var getFA12Balance=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(tokenAddress,accountPkh){var _res,bigMap,__res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"\".concat(apiURL,\"/contracts/\").concat(tokenAddress,\"/storage\"));case 3:_res=_context.sent;bigMap=_res.data.balances||_res.data.ledger;_context.next=7;return axios.get(\"\".concat(apiURL,\"/bigmaps/\").concat(bigMap,\"/keys/\").concat(accountPkh));case 7:__res=_context.sent;if(!__res.data){_context.next=12;break;}return _context.abrupt(\"return\",__res.data.value.balance);case 12:return _context.abrupt(\"return\",\"0\");case 13:_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](0);throw _context.t0;case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,15]]);}));return function getFA12Balance(_x,_x2){return _ref.apply(this,arguments);};}();export var getFA2Balance=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(tokenAddress,accountPkh,tokenId){var _res,bigMap,key,__res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"\".concat(apiURL,\"/contracts/\").concat(tokenAddress,\"/storage\"));case 3:_res=_context2.sent;bigMap=_res.data.ledger;key={nat:tokenId,address:accountPkh};_context2.next=8;return axios.get(\"\".concat(apiURL,\"/bigmaps/\").concat(bigMap,\"/keys/\").concat(JSON.stringify(key)));case 8:__res=_context2.sent;if(!__res.data){_context2.next=13;break;}return _context2.abrupt(\"return\",__res.data.value);case 13:return _context2.abrupt(\"return\",\"0\");case 14:_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](0);throw _context2.t0;case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[0,16]]);}));return function getFA2Balance(_x3,_x4,_x5){return _ref2.apply(this,arguments);};}();export var getFA12TotalSupply=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(tokenAddress){var _res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.get(\"\".concat(apiURL,\"/contracts/\").concat(tokenAddress,\"/storage\"));case 3:_res=_context3.sent;return _context3.abrupt(\"return\",_res.data.totalSupply);case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);throw _context3.t0;case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function getFA12TotalSupply(_x6){return _ref3.apply(this,arguments);};}();export var getFA12Approval=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(tokenAddress,accountPkh,spender){var _res,bigMap,__res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.get(\"\".concat(apiURL,\"/contracts/\").concat(tokenAddress,\"/storage\"));case 3:_res=_context4.sent;bigMap=_res.data.balances||_res.data.ledger;_context4.next=7;return axios.get(\"\".concat(apiURL,\"/bigmaps/\").concat(bigMap,\"/keys/\").concat(accountPkh));case 7:__res=_context4.sent;if(!(__res.data&&__res.data.value.approvals[spender])){_context4.next=12;break;}return _context4.abrupt(\"return\",__res.data.value.approvals[spender]);case 12:return _context4.abrupt(\"return\",\"0\");case 13:_context4.next=18;break;case 15:_context4.prev=15;_context4.t0=_context4[\"catch\"](0);throw _context4.t0;case 18:case\"end\":return _context4.stop();}}},_callee4,null,[[0,15]]);}));return function getFA12Approval(_x7,_x8,_x9){return _ref4.apply(this,arguments);};}();export var getFA2TotalSupply=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(tokenAddress,tokenId){var _res,bigMap,__res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return axios.get(\"\".concat(apiURL,\"/contracts/\").concat(tokenAddress,\"/storage\"));case 3:_res=_context5.sent;bigMap=_res.data.total_supply;_context5.next=7;return axios.get(\"\".concat(apiURL,\"/bigmaps/\").concat(bigMap,\"/keys/\").concat(tokenId));case 7:__res=_context5.sent;if(!__res.data){_context5.next=12;break;}return _context5.abrupt(\"return\",__res.data.value);case 12:return _context5.abrupt(\"return\",\"0\");case 13:_context5.next=18;break;case 15:_context5.prev=15;_context5.t0=_context5[\"catch\"](0);throw _context5.t0;case 18:case\"end\":return _context5.stop();}}},_callee5,null,[[0,15]]);}));return function getFA2TotalSupply(_x10,_x11){return _ref5.apply(this,arguments);};}();","map":{"version":3,"sources":["/workspace/box-defi/dapp/src/api/tokens.ts"],"names":["axios","apiURL","getFA12Balance","tokenAddress","accountPkh","get","_res","bigMap","data","balances","ledger","__res","value","balance","getFA2Balance","tokenId","key","nat","address","JSON","stringify","getFA12TotalSupply","totalSupply","getFA12Approval","spender","approvals","getFA2TotalSupply","total_supply"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\n// Utils\nimport { apiURL } from \"../utils/global\";\n\nexport const getFA12Balance = async (tokenAddress: string, accountPkh: string): Promise<string> => {\n  try {\n    const _res = await axios.get(`${apiURL}/contracts/${tokenAddress}/storage`);\n    const bigMap = _res.data.balances || _res.data.ledger;\n    const __res = await axios.get(`${apiURL}/bigmaps/${bigMap}/keys/${accountPkh}`);\n    if (__res.data) {\n      return __res.data.value.balance;\n    } else {\n      return \"0\";\n    }\n  } catch (err) {\n    throw err;\n  }\n};\n\nexport const getFA2Balance = async (tokenAddress: string, accountPkh: string, tokenId: string): Promise<string> => {\n  try {\n    const _res = await axios.get(`${apiURL}/contracts/${tokenAddress}/storage`);\n    const bigMap = _res.data.ledger;\n    const key = { nat: tokenId, address: accountPkh };\n    const __res = await axios.get(`${apiURL}/bigmaps/${bigMap}/keys/${JSON.stringify(key)}`);\n    if (__res.data) {\n      return __res.data.value;\n    } else {\n      return \"0\";\n    }\n  } catch (err) {\n    throw err;\n  }\n};\n\nexport const getFA12TotalSupply = async (tokenAddress: string): Promise<string> => {\n  try {\n    const _res = await axios.get(`${apiURL}/contracts/${tokenAddress}/storage`);\n    return _res.data.totalSupply;\n  } catch (err) {\n    throw err;\n  }\n};\n\nexport const getFA12Approval = async (tokenAddress: string, accountPkh: string, spender: string): Promise<string> => {\n  try {\n    const _res = await axios.get(`${apiURL}/contracts/${tokenAddress}/storage`);\n    const bigMap = _res.data.balances || _res.data.ledger;\n    const __res = await axios.get(`${apiURL}/bigmaps/${bigMap}/keys/${accountPkh}`);\n    if (__res.data && __res.data.value.approvals[spender]) {\n      return __res.data.value.approvals[spender];\n    } else {\n      return \"0\";\n    }\n  } catch (err) {\n    throw err;\n  }\n};\n\nexport const getFA2TotalSupply = async (tokenAddress: string, tokenId: string): Promise<string> => {\n  try {\n    const _res = await axios.get(`${apiURL}/contracts/${tokenAddress}/storage`);\n    const bigMap = _res.data.total_supply;\n    const __res = await axios.get(`${apiURL}/bigmaps/${bigMap}/keys/${tokenId}`);\n    if (__res.data) {\n      return __res.data.value;\n    } else {\n      return \"0\";\n    }\n  } catch (err) {\n    throw err;\n  }\n};\n"]},"metadata":{},"sourceType":"module"}